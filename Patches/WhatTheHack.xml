<?xml version="1.0" encoding="utf-8" ?>
<Patch>
	<!--Add mechanoid specific operations-->
	<Operation Class="PatchOperationAdd">
		<xpath>*/ThingDef[race/fleshType = "Mechanoid"]</xpath>
		<value>
			<recipes>
				<li>WTH_HackMechanoid</li>
				<li>WTH_ImplantAI</li>
				<li>WTH_HackLocomotion</li>
				<li>WTH_ShutDownMechanoid</li>
				<li>WTH_RepairModule</li>
			</recipes>
			<comps>
			  <li Class="CompProperties_Refuelable">
				<fuelConsumptionRate>40.0</fuelConsumptionRate>
				<fuelCapacity>10.0</fuelCapacity>
				<fuelFilter>
				  <thingDefs>
					<li>WTH_MechanoidParts</li>
				  </thingDefs>
				</fuelFilter>
				<consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
				 <targetFuelLevelConfigurable>true</targetFuelLevelConfigurable>
				<initialConfigurableTargetFuelLevel>10.0</initialConfigurableTargetFuelLevel>
			  </li>
			</comps>
			
		</value>
	</Operation> 
	<Operation Class="PatchOperationAddModExtension">
		<xpath>*/ThingDef[defName = "Mech_Centipede"]</xpath>
		<value>
			<!--In vanilla, centipedes always die due to the damagethreshold before being downed. This patch makes sure they are downed quicker-->
			<li Class="WhatTheHack.DefModExtension_PawnCapacity">
				<minForCapableMoving>0.38</minForCapableMoving>
			</li>
			<!--Cmon, centipedes should be able to carry more than 70-ish kilos --> 
			<li Class="WhatTheHack.DefModExtension_PawnMassCapacity">
				<bonusMassCapacity>35</bonusMassCapacity>
			</li>
		</value>
	</Operation> 
	<!-- Make sure mechanoids don't wander about when drafted --> 
	<Operation Class="PatchOperationInsert">
		<xpath>*/ThinkTreeDef[defName = "Mechanoid"]/thinkRoot[@Class = "ThinkNode_Priority"]/subNodes/li[treeDef="LordDuty"]</xpath> <!--Priority is important here, hence the insert after this specific subNode--> 
		<value>
	        <!-- Wait if drafted -->
			<li Class="ThinkNode_ConditionalDrafted">
			  <subNodes>
				<li Class="ThinkNode_Tagger">
				  <tagToGive>DraftedOrder</tagToGive>
				  <subNodes>
					<li Class="JobGiver_MoveToStandable" />
					<li Class="JobGiver_Orders" />
				  </subNodes>
				</li>
			  </subNodes>
			</li>
		</value>
	</Operation>
	<!-- Mechanoid parts sold from exotic goods trader --> 
	<Operation Class="PatchOperationAdd">
		<xpath>*/TraderKindDef[defName = "Caravan_Outlander_Exotic" or defName = "Orbital_Exotic"]/stockGenerators</xpath>
		<value>
			<li Class="StockGenerator_SingleDef">
					<thingDef>WTH_MechanoidParts</thingDef>
					<countRange>
						<min>0</min>
						<max>70</max>
					</countRange>
			</li>
			<li Class="StockGenerator_SingleDef">
					<thingDef>WTH_MechanoidChip</thingDef>
					<countRange>
						<min>0</min>
						<max>5</max>
					</countRange>
			</li>
		</value>
	</Operation>
</Patch>
